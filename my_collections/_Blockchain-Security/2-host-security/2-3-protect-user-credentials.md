---
layout: single
title:   "存取控制2-3: 金鑰與錢包資料保護"
excerpt: "控制：針對錢包代管機制的錢包相關資料進行妥善保護。<br><br>
是否為區塊鏈特有安全控制：部份" 
date: 2021-09-11 12:14 +0800 # update-time
header:
  overlay_image: /assets/images/header/background.png # 圖片
#   caption: "Photo credit: [**Unsplash**](https://www.pexels.com/zh-tw/search/earth/)" # 可以表示圖片來源
#   overlay_filter: rgba(255,255,255,0.1)
  overlay_color: "#333" # 在純黑背景
  actions:
    - label: "Download PDF"
      url: "/assets/files/SmartIoT2021final.pdf" # 可以讓別人下載檔案

toc: true
toc_sticky: true
toc_icon: "ellipsis-h" # fontawesome
toc_label: "Table of Contents"

sidebar:
  nav: "blockchain"
---
# 控制措施
以區塊鏈應用來說，使用者一般會具有錢包與公私鑰對。這可由使用者自己保管，讓使用者端應用程式將交易簽章送入區塊鏈網路。而使用者端應用程式就需要做好對於使用者金鑰的保護，甚至應提醒使用者應注意的安全防護事項(參見 8.7)。許多時候為避免使用者遺失金鑰，會採用帳號代管的方式，幫使用者保管他們的金鑰，而讓使用者用另外的方式登入，之後再由應用程式去使用保管的金鑰，對相關的交易做簽章後送入區塊鏈當中。

隨著目前反洗錢規定的發展，有可能會要求應用服務提供者要保有使用者的身分資訊，因此即便不進行帳號代管，應用服務提供者也需要保留錢包識別與使用者身分之間對應的資訊，因此也需要對資料進行保護。有關這部分，目前像是一般 PCI-DSS 當中，在 3.5 特別有提到對於對使用者資料加解密之金鑰的保護，包括：

## 金鑰保護
- [ ] 建立文件明確記錄所採用的演算法、協定，與金鑰保護機制
- [ ] 減少與限制對金鑰的存取

**並使用以下方式保護金鑰**：
- [ ] 將金鑰加密並另外保管加密金鑰
- [ ] 使用硬體安全模組負責進行金鑰的保存與運算

**此外，PCI-DSS 的 3.6 也提到了對金鑰管理程序的要求**：
- [ ] 使用強度足夠的加解密金鑰
- [ ] 保護金鑰散布時的安全性
- [ ] 保護金鑰儲存的安全性
- [ ] 經由一定時間後變更金鑰
- [ ] 汰換被破解的金鑰
- [ ] 可以透過分持的方式避免金鑰被單一一人誤用
- [ ] 避免金鑰被未經授權的替換
- [ ] 確保金鑰管理者對於金鑰有足夠的知識

## 區塊鏈代管

**在參考上述程序後，建議採用以下控制**：
- [ ] 使用足夠強度的身分鑑別機制與鑑別使用者
- [ ] 應妥善保護身分鑑別的機密資訊，並不得使用明文的方式進行傳送
- [ ] 明確記錄錢包與金鑰的儲存位置與保護方式

**透過以下的方式減少金鑰被誤用的機會**: 
- [ ] 使用多方運算或是金鑰分持的方式，減少單一裝置被攻擊就可以盜用金鑰送出假的交易。
- [ ] 使用有竄改防止與防止旁通道攻擊的硬體安全模組保護金鑰，並要求在硬體安全模組內進行金鑰的運算。
- [ ] 建立金鑰的備份與還原機制，以減少金鑰儲存裝置毀損所帶來的可用性風險。
- [ ] 減少與限制對於金鑰的存取。


# 適用範圍：
- 應用服務區域 (Zone 3)

# 相關標準之控制措施：

| 標準               | 相關控制措施                             |
| ------------------ | ---------------------------------------- |
| PCI-DSS  3.2.1     | 3.5、3.6 8                               |
| CIS 控制 v7.1      | 10.4、13.1、14.4、14.8、16.4、16.5、18.5 |
| ISO/IEC 27002:2013 | 9.2.4、10.1.1、10.1.2、11.2.7            |
